Элементы SBGN нотации в BioUML
==============================

Сущности
--------

.. |complex| image:: /images/icons/complex.png
.. |entity| image:: /images/icons/entity.png
    
**Сущности** - это элементы графической нотации SBGN, описывающие компоненты биологической системы, участвующие в процессах :ref:`(Рисунок 5) <Pic.5>`. В BioUML доступны все типы сущностей нотации SBGN, которые разделяются на два класса:

-     **материальные**: макромолекула, простое химическое вещество, нуклеиновая кислота, неопределенная сущность, мультимер и комплекс;
-     **концептуальные**: пустое множество и возмущающий агент.

.. _Pic.5:

.. figure:: images/sbgn/entities_rus.png
   :width: 60%
   :alt: Сущности
   :align: center
   
   Рисунок 5. Сущности SBGN
   
.. raw:: html

    <style>
       table {
           border-collapse: collapse;
           width: 100%;
		   background-color: white;
       }
       th, td {
           border: 1px solid #dddddd;
           text-align: left;
           padding: 8px;
       }
       tr:nth-child(even) {
           background-color: white;
       }
       th {
           background-color: #2980B9;
           color: white;
       }
	   .table-bottom-margin {
           margin-top: 20px;
       }
   </style>

   <table>
       <caption>Таблица 3. Элемены диаграммы</caption> 
    <tr>
       <th style="width: 25%;">Название</th>
       <th style="width: 50%;">Описание нотации SBGN</th>
    </tr>
    <tr>
       <td>Неопределенная сущность</td>
       <td>Сущность, тип которой неизвестен либо не имеет прямого биологического значения.</td>
    </tr>
    <tr>
       <td>Простое химическое вещество</td>
       <td>Определяется как противоположность макромолекулы: химическое соединение, которое не образуется путем ковалентного связывания псевдоидентичных остатков. Примерами этого типа могут служить атом, ион, радикал и др.биохимические вещества.</td>
    </tr>
    <tr>
       <td>Макромолекулы</td>
       <td>Биохимические вещества, образующиеся от ковалентного связывания псевдоидентичных единиц - белки, нуклеиновые кислоты, полисахариды.</td>
    </tr>
    <tr>
       <td>Нуклеиновая кислота</td>
       <td>Представляет собой фрагмент макромолекулы, несущий генетическую информацию. Обычно этот тип сущности используют для представления гена или транскрипта.</td>
    </tr>
    <tr>
       <td>Мультимер</td>
       <td>Мультимер представляет собой совокупность множества одинаковых или псевдоидентичных соединений, удерживаемых вместе нековалентными связями. Примером мультимера может служить димерный рецептор. Существуют четыре типа мультимера: мультимер простого химического вещества, мультимер макромолекулы, мультимер с признаками нуклеиновой кислоты и мультимер комплекса.</td>
    </tr>
    <tr>
       <td>Комплекс</td>
       <td>Комплекс представляет собой пул биохимических объектов, каждый из которых состоит из других биохимических объектов, будь то макромолекулы, простые химические вещества, мультимеры или другие комплексы.</td>
    </tr>
    <tr>
       <td>Пустое множество</td>
       <td>Представляет собой отсутствие компонента в модели. Допустим, при создании реакции деградации, у которой отсутствует фактический продукт, на диаграмме будет отображаться пустое множество.</td>
    </tr>
    <tr>
       <td>Возмущающий агент</td>
       <td>Отображает внешнее воздействие на компоненты модели. Например, это может быть изменение температуры, излучение, мутация и др.</td>
    </tr>
   </table>
   
   <div class="table-bottom-margin"></div>

.. note::
   Некоторые типы сущностей могут опционально содержать :ref:`вспомогательные единицы <units>`. При этом одной сущности может соответсвовать несколько вспомогательных единиц. 
 
**Макромолекула (macromolecule)**, **простое химическое вещество (simple chemical)**, **нуклеиновая кислота (nucleic acid feature)**, 
**неопределенная сущность (unspecified)**, **возмущающий агент (perturbing agent)** и **комплекс (complex)** добавляется на диаграмму засчет выбора иконки |entity| на панели инструментов и выборе 
нужного типа сущности в открывшемся окне в поле :guilabel:`sbgb:enityType` :ref:`(Рисунок 6) <Pic.6>`. 

.. _Pic.6:

.. figure:: images/interface/creating_entity.png
   :width: 80%
   :alt: Создание сущности в веб-версии BioUML
   :align: center

   Рисунок 6. Создание сущности в веб-версии BioUML

**Комплекс** может быть создан также путем выбора иконки |complex| на панели инструментров. Для того, чтобы поместить в комплекс другие объекты, необходимо зажать их левой кнопкой мыши и поместить внутрь него. 
   
**Мультимер** создается засчет указания в поле :guilabel:`sbgn:multimer` количества субъединиц, входяших в его состав. Мультимер можеть быть создан для всех типов упомянутых выше сущностей, за исключением возмущающего агента и 
неопределенной сущности. Cозданные мультимер будет содержать :ref:`единицу информации <units>` вида N:n, где n - количество субъединиц в составе мультимера.

Компартмент
-----------

.. |compartment| image:: /images/icons/compartment.png

**Компартмент** является отдельным элементом диаграммы, в составе которого могут находиться сущности :ref:`(Рисунок 7) <Pic.7>`. Компартмент создается с помощью нажаться на иконку |compartment|, расположенную на панели инструментов. 

.. _Pic.7: 

.. figure:: images/sbgn/compartment_rus.png
   :width: 40%
   :alt: Компартмент
   :align: center
   
   Рисунок 7. Компартмент

.. note::
   Отдельная сущность может принадлежать только одному компартменту. Таким образом, «одни и те же» биохимические компоненты, находящиеся в двух разных компартментах, на самом деле представляют собой две разных сущности. 
   После того, как сущность будет перемещена в компартмент, название этой переменной будет изменено путем добавления названия компартмента перед названием сущности. Например, $compartment.entity.
   
.. figure:: images/diagrams/IGF_signaling.jpg
   :width: 100%
   :alt: SBGN диаграмма сигналинга IGF-1
   :align: center

   Рисунок 8. SBGN диаграмма сигналинга IGF-1, содержащая два компартмента - внеклеточное пространство (extracellular) и цитозоль (cytosol)   
   
.. _units:

Вспомогательные единицы
-----------------------

.. |unit_of_information| image:: /images/icons/unit_of_information.png
.. |variable| image:: /images/icons/variable.png
.. |clone_node| image:: /images/icons/clone_node.png
.. |merge_node| image:: /images/icons/merge_node.png

В BioUML доступны все типы *вспомогательных единиц*, описанной в нотации SBGN: единицы информации, переменные состояния и маркеры клонирования :ref:`(Рисунок 9) <Pic.9>`.
Каждой сущности может соответсвовать несколько вспомогательных единиц как одного типа, так и нескольких. 

.. _Pic.9:

.. figure:: images/sbgn/auxilary_units_rus.png
   :width: 40%
   :alt: Вспомогательные единицы
   :align: center
   
   Рисунок 9. Вспомогательные единицы

**Единица информации** используется для добавления дополнительной информации к сущности. Для определенных типов информации, нотация SBGN определяет конкретные префиксы. 
С более подробной информацией о префиксах можно ознакомиться по ссылке (https://sbgn.github.io/).

-   pt - физические характеристики, такие как температура (pc:T), pH (pc:pH) и др. Предполагается, что они будут использоваться для описания характера возмущающего воздействия агента 
    или фенотипа.
-   mt - биологический тип сущности, такие как ДНК (mt:dna), РНК (mt:rna), ион (mt:ion) и др.
-   ct - концептуальные типы сущности, такие как ген (ct:gene), сайт транскрипции (ct:tss) и др. 

.. figure:: images/diagrams/gene_regulation.jpg
   :width: 70%
   :alt: Регуляция экспрессии гена
   :align: center
   
   Рисунок 10. Пример использования единиц информации при создании диаграммы, описывающей процесс регуляции экспрессии гена  
   
Для того, чтобы добавить вспомогательную единицу к сущности, нажмите на иконку |unit_of_information|, расположенную на :ref:`панели инструментов <panel>` и затем на выбранную сущность. 
   
**Переменные состояния** используются для описания изменения физического состояния биологического объекта. Обычно, переменная состояния строится из двух подстрок, разделенных символом "@", 
первая из которых идентифицирует значение переменной состояния, а вторая — ее имя. Например, при описании процесса фосфорилирования белка, для нефосфорилированной формы может использоваться 
переменная состояния "@S122" либо пустое состояние, обозначающая позицию фосфорилирования, и для фосфорилированной формы - "P@S122", где P - остаток фосфорной кислоты. Символ "@" опускается, если
переменная состояния не имеет имени, как например, при обозначении активной и неактивной формы белка. 

Для некоторых переменных состояния отображающих ковалетнтные модификации макромолекул существуют определенные идентификаторы. Например, фосфорилирование (P), ацетилирование (Ac), метиилирование (Me) и др.

Для того, чтобы добавить переменную состоянию к сущности, нажмите на иконку |variable|, расположенную на :ref:`панели инструментов <panel>` и затем на выбранную сущность. 

.. figure:: images/diagrams/phosphorylation.jpg
   :width: 60%
   :alt: Регуляция экспрессии гена
   :align: center
   
   Рисунок 11. Пример использования переменных состояния при создании диаграммы, описывающей процесс фосфорилирования белка 

**Маркеры клонирования** используются при дублировании сущности на диаграмме.

Для создания клона нажмите на сущность, которую хотите клонировать и затем на иконку |clone_node|, расположенную на общей панели управления. Чтобы объединить клоны, нажмите на клон и затем на иконку 
|merge_node|. 

.. figure:: images/diagrams/glycolysis.jpg
   :width: 100%
   :alt: Гликолиз
   :align: center
   
   Рисунок 12. Пример использования маркеров клонирования при создании диаграммы, описывающей процесс гликолиза. АТФ и АДФ встречаются в этом пути 4 раза, поэтому оба идентифицируются с помощью клон-маркера.
   
Заметка
-------

.. |note| image:: /images/icons/note.png
.. |note_link| image:: /images/icons/note_link.png

**Заметка** используется для добавления дополнительной информации, например, детального описания молекулярных механизмов, отображенных на диаграмме :ref:`(Рисунок 12) <Pic.12>`. Аннотация может быть представлена как отдельный элемент на диаграмме,
так и быть связанной с сущностью при помоши **ребра заметки**.

.. _Pic.12:

.. figure:: images/sbgn/annotation_rus.png
   :width: 40%
   :alt: Заметка
   :align: center
   
   Рисунок 12. Заметка

Для того, чтобы создать заметку, нажмите на иконку |note|, расположенную на :ref:`панели инструментов <panel>`. Затем, вы можете связать ее с сущностью, создав ребро заметки, нажав на иконку |note_link|, 
и соединив этим ребром сущность и аннотацию.

.. figure:: images/diagrams/annotation.png
   :width: 30%
   :alt: Заметка
   :align: center
   
   Рисунок 13. Пример использования заметки, связанной с сущностью. 

.. _process:

Процессы 
--------

**Процессы** преобразуют один или несколько пулов сущностей в один или несколько пулов сущностей, идентичных или разных. На диаграмме процессы отображаются в виде круга или квадрата, 
которые соединены с связанные с небольшими дугами (ребрами), прикрепленными к центрам противоположных сторон фигуры процесса :ref:`(Рисунок 14) <Pic.14>`.

.. note:: 
   Создание реакций с использованием описанных элементов диаграммы будет обсуждаться в разделе :ref:`"Создание реакций" <reactions>`. 

Согласно нотации SBGN существует один общий тип - *базовый процесс (process)*, а также пять типов специфических процессов: *пропущенный процесс (omitted process)*, 
*неопределенный процесс (uncertain process)*, *ассоциация (association)*, *диссоциация (dissociation)* и
*фенотип (phenotype)*. 

.. _Pic.14: 

.. figure:: images/sbgn/processes_rus.png
   :width: 40%
   :alt: Процессы
   :align: center
  
   Рисунок 14. Процессы 

.. raw:: html

   <table>
       <caption>Таблица 4. Описание процессов</caption> 
    <tr>
       <th style="width: 25%;">Тип процесса</th>
       <th style="width: 50%;">Описание</th>
    </tr>
    <tr>
       <td>Базовый процесс</td>
       <td>Общий процесс, описывающий преобразование набора биохимических объектов в другой набор сущностей. Примеры: ковалентные модификации белков, транслокация.</td>
    </tr>
    <tr>
       <td>Пропущенный процесс</td>
       <td>Процесс, который опускается при создании диаграммы, может соответствовать нескольким фактическим процессам.</td>
    </tr>
    <tr>
       <td>Ассоциация</td>
       <td>Нековалентное связывание биологических объектов и образование комплекса. Примеры: образование мультимера, комплекса.</td>
    </tr>
    <tr>
       <td>Диссоциация</td>
       <td>Разрыв нековалентного связывания между биологическими объектами. Примеры: распад комплекса, мультимера.</td>
    </tr>
    <tr>
       <td>Фенотип</td>
       <td>Процесс, приводящий к проявлению фенотипа. Пример: связь белка c-Fos с фенотипом через процесс транскрипции генов.</td>
    </tr>
   </table>
   
   <div class="table-bottom-margin"></div>

.. _edges:

Ребра
-----

По нотации SBGN выделяется четыре типа ребер - *ребра потоков*, *ребра модуляции*, :ref:`логическое ребро <logical arc>` и *ребро аннотации*.

*Ребра потоков* позволяют представить, какие пулы сущностей потребляются и производятся процессом. 
Ребра **потребления** связывают процессы с реагентами, а ребра **производства** связывают процессы с продуктами :ref:`(Рисунок 15) <Pic.15>`. При создании реакции в BioUML эти ребра создаются автоматически. 

.. _Pic.15:

.. figure:: images/diagrams/translocation.png
   :width: 50%
   :alt: Транслокация
   :align: center
   
   Рисунок 15. Диаграмма, описывающая транспорт иона Ca2+. В реакции траслокации тип использованного процесса - базовый процесс, с ребрами потребления и продукции.

.. _Pic.16:

.. _modulation:   
   
*Ребра модуляции* представляют собой влияние пулов сущностей на процессы. Выделяется пять видов ребер: *модуляция*, *стимуляция*, *катализ*, *ингибирование* и *необходимая стимуляция* :ref:`(Рисунок 16) <Pic.16>`. 

.. figure:: images/sbgn/edges_rus.png
   :width: 40%
   :alt: Ребра
   :align: center
   
   Рисунок 16. Ребра 
   
**Модуляция** используется, когда неизвестно точное направление процесса - положительное или отрицательное воздействие, которое может зависеть, например,
от концентрации реактантов. Примером модуляции может служить влияние никотина на конформацию никотинового рецептора ацетилхолина :ref:`(Рисунок 17) <Pic.17>`. Высокие концентрации никотина 
открывают рецептор, тогда как низкие концентрации могут снизить его чувствительность, не открывая его.

.. _Pic.17:

.. figure:: images/diagrams/modulation.png
   :width: 50%
   :alt: Модуляция
   :align: center

   Рисунок 17. Модуляция открытия никотиновых рецепторов никотином
   
**Стимуляция** положительно влияет на поток процесса, представленного целевым процессом. Эта стимуляция может представлять собой, например, катализ или положительную аллостерическую регуляцию. Однако, катализ существует независимо в SBGN нотации.

.. _Pic.18:

.. figure:: images/diagrams/stimulation.png
   :width: 60%
   :alt: Стимуляция
   :align: center
   
   Рисунок 18. Противоположное влияние агонистов и обратных агонистов на рецептор GPCR. При создании реакций были использованы ребра стимуляции.
   
**Катализ** — это частный случай стимуляции, при котором эффектор положительно влияет на поток процесса, представленного целевым процессом. Положительное влияние на процесс обусловлено снижением энергии активации реакции.

.. figure:: images/diagrams/catalysis.png
   :width: 60%
   :alt: Катализ
   :align: center
   
   Рисунок 19. Киназа МАPKK катализирует фосфорилирование МАРК

**Ингибирование** отрицательно влияет на поток процесса, представленного целевым процессом. Ингибирование может быть, например, конкурентным ингибированием или аллостерическим ингибированием.

.. figure:: images/diagrams/inhibition.png
   :width: 60%
   :alt: Ингибирование
   :align: center
   
   Рисунок 20. Белок Gαi, ингибирует превращение АТФ в цАМФ
   
**Необходимая стимуляция** – это стимуляция, необходимая для того, чтобы процесс состоялся. 

.. figure:: images/diagrams/translation.png
   :width: 70%
   :alt: Трансляция
   :align: center
   
   Рисунок 21. Tранскрипция гена и последующая трансляция

Логические операторы
--------------------

*Логические операторы* обозначают механизм совместного действия пула или нескольких пулов сущностей. 
Выделяются три типа логических операторов: "И", "ИЛИ", "НЕ" :ref:`(Рисунок 22) <Pic.22>`.

.. _Pic.22:

.. figure:: images/sbgn/logical_operators_rus.png
   :width: 40%
   :alt: Логические операторы 
   :align: center
   
   Рисунок 22. Логические операторы 
   
.. note::
   Добавление логических операторов в реакцию обсуждается в разделе :ref:`Визуальное моделирование реакций <logical_operator>` 

.. _logical arc:

**Логическое ребро** создается автоматические при использовании логического оператора и соединяет пул сущностей и логический оператор.

**Логический оператор "И"** используется для обозначения того, что все узлы, связанные как входные, необходимы для получения выходных данных. 
Примером использования этого логическоского оператора заключается в синтезе мРНК IRF1, для которого необходимы как ген IRF1, так и комплекс, образованный белком STAT1 и регуляторной областью гена IRF1-GAS. 
Таким образом, логический оператор "И" связывает оба компонента, стимулируя процесс, который приводит к синтезу мРНК IRF1 :ref:`(Рисунок 23) <Pic.23>`.

.. _Pic.23:

.. figure:: images/diagrams/and.png
   :width: 50%
   :alt: И
   :align: center
   
   Рисунок 23. Пример использования логического оператора "И"

**Логический оператор "ИЛИ"** используется для обозначения того, что любой узел, связанный как входной, достаточен для получения выходных данных.
В следующем примере показана транскрипция мРНК SDH2-3, активируемая пулом комплексов транскрипционных факторов, каждый из которых способен в одиночку активировать 
транскрипцию :ref:`(Рисунок 24) <Pic.24>`.  

.. _Pic.24:

.. figure:: images/diagrams/or.png
   :width: 70%
   :alt: ИЛИ
   :align: center
   
   Рисунок 24. Пример использования логического оператора "ИЛИ"

**Логический оператор "НЕ"** используется для обозначения того, что выходные данные получаются только при отсутствии определенных входных данных. Следующий пример показывает, что продукция комплекса циклин-CDK не 
стимулируется белком p21 :ref:`(Рисунок 25) <Pic.25>`.

.. _Pic.25:

.. figure:: images/diagrams/not.png
   :width: 70%
   :alt: НЕ
   :align: center
   
   Рисунок 25. Пример использования логического оператора "НЕ"
   









   
   